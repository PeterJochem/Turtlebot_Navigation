<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Turtlebot_Navigation: Navigation Stack</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Turtlebot_Navigation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Navigation Stack </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This is a navigation stack from scratch implemented in ROS for a differential drive robot. I am using the Turtlebot3. I am still working on it at the moment! Professor <a href="https://robotics.northwestern.edu/people/profiles/faculty/elwin-matt.html">Matt Elwin</a> at Northwestern put together a <a href="https://nu-msr.github.io/navigation_site/">course</a> for building a navigation stack from scratch. He sketched out what each step should look like and suggested ways of testing. I could not have done it without his guidance, so thanks Matt! I am currently working on implementing Feature-Based Kalman Filtering SLAM.</p>
<h1>Results So Far</h1>
<p>Here are examples of the robot navigating to waypoints in RVIZ, real life, and in Gazebo. More details can be found below. </p><table class="doxtable">
<tr>
<td>RVIZ Visualization </td><td>Real Hardware </td><td>Gazebo  </td></tr>
<tr>
<td><div class="image">
<img src="images/rviz_pentagon_resized.gif" width="336" height="336"/>
</div>
 </td><td><div class="image">
<img src="images/pentagon.gif" width="336" height="336"/>
</div>
 </td><td><div class="image">
<img src="images/gazebo_waypoints_resized.gif" width="336" height="366"/>
</div>
  </td></tr>
</table>
<h1>Rigid2D Library</h1>
<p>The first major step of this project was creating a C++ library for representing 2D rigid body transformations. I used screw theory as presented in <a href="http://hades.mech.northwestern.edu/images/7/7f/MR.pdf">Modern Robotics</a> for 2D frames. The main purpose of this library is to enable us to convert to and from the robot's encoder data and it's rigid body transformations. For example, given that we observed a certain number of encoder ticks per unit time on each wheel, what is the twist that we underwent. What is the SE(2) transformation we will undergo if we follow that for a unit of time? It also lets us take a desired twist and compute what velocities to set for each wheel in order to make the robot follow the given twist in a unit of time. This library facilitates odometry calculations so that higher levels of the navigation stack can abstract them.</p>
<h1>Visualizing Rigid2D and Robot Geometry in RVIZ</h1>
<p>Below is an image from RVIZ of the diff drive robot navigating to 5 waypoints using a feed forward controller. In this case, the waypoints form a pentagon. RVIZ was a very useful tool for both visualzing and testing the rigid2D library. <br />
 &lt;img src="images/tbot_pentagon.gif" alt=""Diff Drive Robot Navigating to Waypoints""/&gt;</p>
<h1>Turtlebot3 Hardware</h1>
<p>I am using the Turtlebot3 Burger. Here is a video of the robot following the same pentagon as in the above gif but in real life!! <br />
 &lt;img src="images/pentagon.gif" alt=""Turtlebot Pentagon Outside""/&gt;</p>
<h1>Gazebo Simulation</h1>
<p>I wrote a plugin for Gazebo to simulate my differential drive robot. This allows me to iterate faster and avoid using the robot. The plugin listens for wheel commands that are normally sent to the real robot's motors and uses them to update the simulated robot's wheel velocities. The plugin also simulates the encoder and laser data normally published by the real robot. This allows us to have a pretty realistic and dynamic simulation of the robot and its enviroment.</p>
<p>Below is a video of the robot navigating to waypoints in gazebo using a feedback controller. It also shows RVIZ which displays the robot's internal odometry data. This is where the robot thinks it is. The coordinate axes are not aligned but you can still see that over time, the robot's actual position (the Gazebo simulation) drifts from the idealized position in RVIZ. The RVIZ robot finishes the pentagon at almost exactly the same point it started at. This is visualized by the blue dots. In contrast, the Gazebo robot starts at the origin and finishes about a quarter meter from the origin. This is due to the dynamics of the simulation. RVIZ simply displays the odometry data from the robot. These are purely kinematic calculations. The odometry calculations do not model the robot's inertia, the frictional forces in the enviroment, or any other dynamic quality. Maybe a future iteration could incorporate these types of dynamics in order to obtain better state estimations. In contrast, the Gazebo simulation captures these dynamics and results in a realistic simulation of the robot running in real life. The blue ring is the simulated laser data. <br />
 &lt;img src="images/gazebo_waypoints.gif" alt=""Gazebo Waypoints""/&gt; <a href="http://www.youtube.com/watch?v=eHXuRXVKE6k" title="Gazebo and RVIZ Comparison"></a></p>
<h1>Testing</h1>
<p>I used the gtest framework for testing my Rigid2D library. This was extremly helpful for debugging and I will definitely use gtest again! I also used rostest to test that my ROS nodes were being set up correctly. More details about testing can be found in the rigid2d package.</p>
<h1>Doxygen</h1>
<p>I also used Doxygen to generate documentation of files, classes, and methods. The Doxygen documentation is available at</p>
<h1>ROS Packages</h1>
<p>I implemented a few ROS packages for this project. Below is a quick description of each. More details can be found in the README.md for each package.</p>
<h2>tsim</h2>
<p>This package was mainly for visualizing the commands I was sending to the robot in the early stages of the project. It has a FeedForward controller node which I used to make a simulated, kinematic robot rotate, translate, and navigate to waypoints. The simulation is from the ROS developers and includes a GUI to visualize the commands being sent to the robot and how it would move, kinematically.</p>
<h2>rigid2d</h2>
<p>This package implements rigid body calculations that are useful for odometry. The src/rigid2D/config folder also has derivations of the robot's equations of motion.</p>
<h2>nuturtle_description</h2>
<p>This package contains descriptions of the robot's geometry and urdf.</p>
<h2>nuturtle_gazebo</h2>
<p>This contains the Gazebo plugin and another urdf for the Gazebo simulation. The extra urdf includes the original urdf and then adds the extra data required for Gazebo, such as inertias and frictional coefficients. This also has a node implementing a feedback controller.</p>
<h2>nuturtle_robot</h2>
<p>This package has nodes which bridge the gap between the higher level control and the lower level interactions with the motors and other hardware. These extra nodes make it much easier to swap out the real robot for a simulated robot in Gazebo.</p>
<h3>Notes to Self</h3>
<p>Remember to put this into the devel/setup.bash <br />
 export ROS_MASTER_URI=<a href="http://192.168.1.100:11311">http://192.168.1.100:11311</a> <br />
 export ROS_IP=192.168.1.100 </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
